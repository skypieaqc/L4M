@model IEnumerable<blogsite.Models.Comment>
@{
    ViewData["Title"] = "Ana Sayfa";
    Layout = null;
}
@{
    bool showComments = ViewData["ShowComments"] as bool? ?? false;
}
@Html.AntiForgeryToken()

<!DOCTYPE html>
<html>
<head>
    <title>@ViewData["Title"]</title>
    <!-- CSS dosyası -->
    <link rel="stylesheet" href="~/css/index.css" />
</head>
<body>
    <!-- En ÜSTTEKİ Kullanıcı Durum Çubuğu -->
    <div id="userStatusBarTop" style="position: fixed; top: 0; left: 0; width: 100%; background: rgba(0,0,0,0.7); color: white; padding: 8px 15px; z-index: 2000; display: flex; justify-content: space-between; align-items: center; font-size: 14px; border-bottom: 1px solid #444;">
        <div id="userInfoTop">
            @if (User.Identity.IsAuthenticated)
            {
                <span>Hoş geldiniz, <strong>@User.Identity.Name</strong>!</span>
                <span style="margin-left: 15px; background: @(User.IsInRole("Admin") ? "#d9534f" : "#5bc0de"); padding: 3px 8px; border-radius: 10px; font-size: 12px;">
                    @(User.IsInRole("Admin") ? "Admin" : "Kullanıcı")
                </span>
            }
            else
            {
                <span>Misafir modundasınız</span>
            }

            @if (User.IsInRole("Admin"))
            {
                <li class="nav-item">
                    <a class="nav-link" asp-controller="Admin" asp-action="Dashboard">Admin</a>
                </li>
            }
        </div>
        <div>
            @if (User.Identity.IsAuthenticated)
            {
                <!-- YENİ HALİ (POST metoduyla çalışacak) -->
                <form asp-controller="Account" asp-action="Logout" method="post" style="display: inline;">
                    <button type="submit" style="background: none; border: none; color: #ff6b6b; cursor: pointer; padding: 0; margin-left: 15px;">
                        Çıkış Yap
                    </button>
                </form>
            }
            else
            {
                <a href="/Account/Login" style="color: #4ecdc4; margin-left: 15px; text-decoration: none;">Giriş Yap</a>
                <a href="/Account/Register" style="color: #4ecdc4; margin-left: 10px; text-decoration: none;">Kayıt Ol</a>
            }
        </div>
    </div>

    <!-- 3D Model Container -->
    <div id="modelContainer"></div>

    <!-- Yükleme Ekranı -->
    <div id="loadingOverlay">
        <div style="text-align: center;">
            <h2>Model Yükleniyor...</h2>
            <progress id="progressBar" value="0" max="100" style="width:300px; height:20px;"></progress>
        </div>
    </div>

    <!-- Hex Çerçeve Sahnesi (Üst Grup) -->
    <div id="hexSceneUpper" class="hex-scene"></div>

    <!-- Hex Çerçeve Sahnesi (Alt Grup) -->
    <div id="hexSceneLower" class="hex-scene"></div>

    <!-- Geçiş Okları -->
    <div class="nav-arrow" id="leftArrow">❮</div>
    <div class="nav-arrow" id="rightArrow">❯</div>

    <!-- Scroll Okları -->
    <div class="scroll-arrow" id="upArrow">↑</div>
    <div class="scroll-arrow" id="downArrow">↓</div>

    <!-- En ALTTAKİ Kullanıcı Durum Çubuğu -->
    <div id="userStatusBarBottom" style="position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(0,0,0,0.7); color: white; padding: 8px 15px; z-index: 2000; display: flex; justify-content: space-between; align-items: center; font-size: 14px; border-top: 1px solid #444;">
        <div id="userInfoBottom">
            @if (User.Identity.IsAuthenticated)
            {
                <span>Oturum: <strong>@User.Identity.Name</strong></span>
            }
            else
            {
                <span>Giriş yapılmadı</span>
            }
        </div>
        <div>
            @if (User.Identity.IsAuthenticated)
            {
                <span>Son aktivite: @DateTime.Now.ToString("HH:mm")</span>
            }
        </div>
    </div>

    <!-- Three.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/GLTFLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/controls/OrbitControls.js"></script>

    <!-- ViewData değerlerini JavaScript'e aktar -->
    <script>
        window.showComments = @Json.Serialize(showComments);
    </script>

    <!-- Ana JavaScript dosyası -->
    <script src="~/js/index.js"></script>
</body>
</html>